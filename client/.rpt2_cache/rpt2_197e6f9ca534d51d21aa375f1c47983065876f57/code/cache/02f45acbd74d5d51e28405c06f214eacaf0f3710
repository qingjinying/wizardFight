{
  "code": "import { ui } from \"../ui/layaMaxUI\";\r\nexport class WarMapView extends ui.warMapUI {\r\n    constructor() {\r\n        super();\r\n        this.minX = -1096;\r\n        this.minY = -155;\r\n        this.mLastMouseX = 0;\r\n        this.mLastMouseY = 0;\r\n        this.mX = 0;\r\n        this.mY = 0;\r\n        this.glowFilter = new Laya.GlowFilter(\"#ffffff\", 10, 0, 0);\r\n        console.log(\"Laya.stage.width\", Laya.stage.width, \"Laya.stage.height\", Laya.stage.height);\r\n        this.operationBox.y = Laya.stage.height - 120;\r\n        this.conscriptionPanel.y = Laya.stage.height - 100;\r\n        this.nothing_dialog.y = ~~(Laya.stage.height / 2 - 100);\r\n        this.minY = Laya.stage.height - 1240;\r\n        this.minX = Laya.stage.width - 1601;\r\n        this.on(Laya.Event.MOUSE_DOWN, this, this.mouseDown);\r\n        this.on(Laya.Event.MOUSE_UP, this, this.mouseUp);\r\n        this.area1.on(Laya.Event.CLICK, this, this.areaClick, [1]);\r\n        this.area2.on(Laya.Event.CLICK, this, this.areaClick, [2]);\r\n        this.area3.on(Laya.Event.CLICK, this, this.areaClick, [3]);\r\n        this.con_btn_ctrl.on(Laya.Event.MOUSE_DOWN, this, this.conMouseDown);\r\n        this.con_btn_ctrl.on(Laya.Event.MOUSE_UP, this, this.conMouseUp);\r\n    }\r\n    areaClick(areaID) {\r\n        console.log(areaID);\r\n        let ins = this[`area${areaID}`];\r\n        this.applayFilter(ins);\r\n        this.drawDottedLine(1, 2);\r\n    }\r\n    applayFilter(ins) {\r\n        if (this.curFilterIns == ins)\r\n            return;\r\n        if (this.curFilterIns) {\r\n            this.curFilterIns.filters = [];\r\n        }\r\n        ins.filters = [this.glowFilter];\r\n        this.curFilterIns = ins;\r\n    }\r\n    drawDottedLine(startID, endID) {\r\n        this.lineBox.graphics.clear(true);\r\n        let num = 30;\r\n        let startX = 1383;\r\n        let startY = 168;\r\n        let endX = 1272;\r\n        let endY = 140;\r\n        let disX = endX - startX;\r\n        let disY = endY - startY;\r\n        let lenX = disX / num;\r\n        let lenY = disY / num;\r\n        for (let i = 1; i <= num; i += 2) {\r\n            this.lineBox.graphics.drawLine(startX + (lenX * i), startY + (lenY * i), startX + (lenX * i) + lenX, startY + (lenY * i) + lenY, \"#FFFFFF\", 3);\r\n        }\r\n    }\r\n    mouseDown() {\r\n        this.mLastMouseX = Laya.stage.mouseX;\r\n        this.mLastMouseY = Laya.stage.mouseY;\r\n        this.on(Laya.Event.MOUSE_MOVE, this, this.mouseMove);\r\n    }\r\n    mouseMove() {\r\n        let moveX = this.mX + (Laya.stage.mouseX - this.mLastMouseX);\r\n        let moveY = this.mY + (Laya.stage.mouseY - this.mLastMouseY);\r\n        if ((moveX <= 0) && (moveX > this.minX)) {\r\n            this.container.x = moveX;\r\n        }\r\n        if ((moveY <= 0) && (moveY > this.minY)) {\r\n            this.container.y = moveY;\r\n        }\r\n    }\r\n    mouseUp() {\r\n        this.mX = this.container.x;\r\n        this.mY = this.container.y;\r\n        this.off(Laya.Event.MOUSE_MOVE, this, this.mouseMove);\r\n        this.con_btn_ctrl.off(Laya.Event.MOUSE_MOVE, this, this.conMouseMove);\r\n    }\r\n    conMouseDown(e) {\r\n        e.stopPropagation();\r\n        this._conX = this.con_btn_ctrl.mouseX;\r\n        this._conValue = this.con_btn_ctrl.value;\r\n        this.con_btn_ctrl.on(Laya.Event.MOUSE_MOVE, this, this.conMouseMove);\r\n    }\r\n    conMouseMove() {\r\n        let distance = this.con_btn_ctrl.mouseX - this._conX;\r\n        let rate = distance / 256;\r\n        let value = rate + this._conValue;\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        if (value < 0) {\r\n            value = 0;\r\n        }\r\n        this.con_btn_ctrl.value = value;\r\n        this.conUpdateText();\r\n    }\r\n    conMouseUp() {\r\n        this.off(Laya.Event.MOUSE_MOVE, this, this.mouseMove);\r\n        this.con_btn_ctrl.off(Laya.Event.MOUSE_MOVE, this, this.conMouseMove);\r\n    }\r\n    conUpdateText() {\r\n        let all = 1000;\r\n        let current = Math.ceil(all * this.con_btn_ctrl.value);\r\n        let text = `招募 ${current} 单位, 费用 ${current} 金`;\r\n        this.con_text.text = text;\r\n    }\r\n}\r\n",
  "references": [
    "C:/game/demo1/myLaya/src/ui/layaMaxUI.ts"
  ]
}
